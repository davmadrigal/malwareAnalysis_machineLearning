import os
import csv

# Directory 
directory = '.'
total=0
# Iterate all files in the directory
for file_name in os.listdir(directory):
    if file_name.endswith('.csv'):
        path_file = os.path.join(directory, file_name)
        total=0 
        # open file and count
        with open(path_file, newline='', encoding='utf-8') as archivo_csv:
            my_reader = csv.reader(archivo_csv)
            # Read first line
            try:
                primera_fila = next(my_reader)
                num_columns = len(primera_fila)
                total = total + num_columns
                print(f'The file "{file_name}" has {num_columns} columns.')
                print(f'Total:  "{total}"')
            except StopIteration:
                print(f'File "{file_name}" is empty.')

